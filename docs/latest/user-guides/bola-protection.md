# BOLA protection

The **BOLA protection** section of the Wallarm Console UI enables you to configure mitigation of the [BOLA (IDOR) attacks](../attacks-vulns-list.md#broken-object-level-authorization-bola) targeted at the API endpoints explored by the **API Discovery** module.

This section is available under the following conditions:

* The [API Discovery](../about-wallarm/api-discovery.md) module is enabled
* The user [role](settings/users.md#user-roles) is either **Administrator** or **Global Administrator**

!!! info "Variations of BOLA mitigation"

    BOLA mitigation is available in the following variations:

    * Automated mitigation for the endpoints explored by the **API Discovery** module (the UI for configuration is covered in this article)
    * Mitigation for any endpoints protected by the Wallarm nodes - this option is configured manually via the corresponding trigger

    Find more details in the [general instructions on BOLA (IDOR) protection](../admin-en/configuration-guides/protecting-against-bola.md).

## Configuring automated BOLA protection

For Wallarm to analyze endpoints explored by the API Discovery module for BOLA vulnerabilities and protect those that are at risk, **turn the switch to the enabled state**.

![!BOLA trigger](../images/user-guides/bola-protection/trigger-enabled-state.png)

Once protection is enabled, the default Wallarm behavior is the following:

* Defines API endpoints that are most likely to be the target of the BOLA attacks, e.g. those with [variability in path parameters](../about-wallarm/api-discovery.md#variability-in-endpoints): `domain.com/path1/path2/path3/{variative_path4}`.

    Only API endpoints explored by the **API Discovery** module are protected against the BOLA attacks in the automated way.

    !!! info "Identification of vulnerable endpoints takes some time"
        Wallarm applies the BOLA protection settings only after some time it takes for vulnerable API endpoint identification. During this time, Wallarm deeply observes a discovered API structure and incoming traffic trends.
* Does not consider the first 50 requests sent from the same IP to vulnerable endpoints in 30 seconds to be BOLA attacks.
* Does not block BOLA attacks, it only registers them in the event list when the threshold of requests from the same IP is reached. The requests will keep going to your applications.
* Reacts to the [changes in API structure](api-discovery.md#tracking-changes-in-api-structure) by protecting new vulnerable endpoints and deleting triggers for removed endpoints.

The **BOLA protection** section UI enables you to fine-tune the default Wallarm behavior by editing the BOLA autodetection template as follows:

* Change the threshold for requests from the same IP to be marked as the BOLA attacks.
* Change the reaction when exceeding threshold - set to [denylisting](ip-lists/denylist.md) of the BOLA attack source IPs.

![!BOLA trigger](../images/user-guides/bola-protection/trigger-template.png)

## Resulting triggers

Based on the BOLA autodetection template, Wallarm generates individual triggers to protect any API endpoints that are potential targets of BOLA attacks.

The generated triggers are displayed in **Triggers** â†’ **Automatically generated**, e.g.:

![!BOLA trigger](../images/user-guides/triggers/autogenerated-triggers.png)

The protected endpoints are also [highlighted with the corresponding icon](../about-wallarm/api-discovery.md#automatic-bola-protection) in the **API Discovery** section of the Wallarm Console UI.

## Disabling automated BOLA protection

To disable automated BOLA protection, turn the switch to the disabled state in the **BOLA protection** section.

Once your API Discovery subscription is expired, automated BOLA protection will be disabled automatically.
